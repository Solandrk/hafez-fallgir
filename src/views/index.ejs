<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุงู ุญุงูุธ</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body class="text-center">
    <div class="container mt-5">
        <img src="/images/logo.png" alt="ููฺฏู ุงูุฌูู ุนูู ููุดุฑูุงู" class="img-fluid mb-3" style="max-width: 150px;">
        <h1 class="mb-4">ุจู ูุงู ุญุงูุธ ฺฏุฑ ุงูุฌูู ุนูู ูููุฏุณ ฺฉุงููพูุชุฑ ููุดุฑูุงู ุฎูุด ุขูุฏุฏ</h1>
        <% if (poem) { %>
            <div id="falBox" class="alert alert-success" style="cursor: pointer;">
                <p><strong>ุดุนุฑ:</strong> <span><%= poem.poem %></span></p>
                <p><strong>ูุนู:</strong>  <span><%= poem.meaning %> </span></p>
                <p><strong>ููููู:</strong> <span> <%= poem.concept.interpretation %> </span></p>
                <p><strong>ุฏุฑุณ ุฒูุฏฺฏ:</strong> <span> <%= poem.concept.life_lesson %></span></p>
                <p><strong>ูุธุฑ ููุด ูุตููุน:</strong> <span> <%= poem.ai_opinion %></span></p>
                <p><strong>ฺฉูฺฉ ฺฉู ุงูุฌุง ู ุจุง ุฏูุณุชุงู ุฏุฑ ฺฏุฑูู ุงูุฌูู ุจู ุงุดุชุฑุงฺฉ ุจุฒุงุฑ</strong></p>
            </div>
        <% } else if (message) { %>
            <p class="alert alert-danger"><%= message %></p>
        <% } else { %>
            <p dir="rtl">ุฏุฑ ุตูุฑุช ุชูุงู ุจู ุฏุฑุงูุช ูุงู ุฑู ุฏฺฉูู ุฒุฑ ฺฉูฺฉ ฺฉูุฏ:</p>
        <% } %>
        <button id="getFalButton" class="btn btn-danger mt-3">ูุงู ุญุงูุธ ูู ุฑุง ุจฺฏุฑ</button>
    </div>

    <!-- Dialog Modal -->
    <div id="dialogModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>ูุงู ุญุงูุธ</h2>
            <p id="dialogContent"></p>
            <button id="shareButton" class="btn btn-light">ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ</button>
            <button id="closeButton" class="btn btn-danger mt-2">ุจุณุชู</button>
        </div>
    </div>

    <script>
        const falBox = document.getElementById('falBox');
        const dialogModal = document.getElementById('dialogModal');
        const dialogContent = document.getElementById('dialogContent');
        const shareButton = document.getElementById('shareButton');
        const closeButton = document.getElementById('closeButton');
        const button = document.getElementById('getFalButton');

        let clickedOnce = false;

        button.addEventListener('click', () => {
            if (!clickedOnce) {
                alert('ุฏุงูุดุฌู ูุญุชุฑู ุงุจุชุฏุง ูุช ฺฉูุฏ!');
                clickedOnce = true;
            } else {
                window.location.href = '/fal';
            }
        });

        falBox?.addEventListener('click', () => {
            dialogContent.innerHTML = `
                <p><strong>ุดุนุฑ:</strong> ${falBox.querySelector('p:nth-child(1)').querySelector('span').textContent}</p>
                <p><strong>ูุนู:</strong> ${falBox.querySelector('p:nth-child(2)').querySelector('span').textContent}</p>
                <p><strong>ููููู:</strong> ${falBox.querySelector('p:nth-child(3)').querySelector('span').textContent}</p>
                <p><strong>ูุธุฑ ููุด ูุตููุน:</strong> ${falBox.querySelector('p:nth-child(5)').querySelector('span').textContent}</p>
                <p>ุงูุฌูู ุนูู ูููุฏุณ ฺฉุงููพูุชุฑ ุฏุงูุดฺฏุงู ุตูุนุช ููุดุฑูุงู ุจุงุจู</p>
            `;
            dialogModal.style.display = 'block';
        });

        closeButton.addEventListener('click', () => {
            dialogModal.style.display = 'none';
        });

        shareButton.addEventListener('click', () => {
            const textToCopy = `
โูุงู ุญุงูุธ ุงู ุฏุงูุดุฌู ุนุฒุฒ ุฏุงูุดฺฏุงู ุฑูฺฉ ฺฉ:

๐ฅุดุนุฑ:โ
${falBox.querySelector('p:nth-child(1)').querySelector('span').textContent}


๐ฅูุนู :โ
${falBox.querySelector('p:nth-child(2)').querySelector('span').textContent}


๐ุฏุฑุณ ุฒูุฏฺฏ : 
${falBox.querySelector('p:nth-child(3)').querySelector('span').textContent}


๐ฌูุธุฑ ููุด ูุตููุน :โ
${falBox.querySelector('p:nth-child(5)').querySelector('span').textContent}


ุงูุฌูู ุนูู ูููุฏุณ ฺฉุงููพูุชุฑ ุฏุงูุดฺฏุงู ุตูุนุช ููุดุฑูุงู ุจุงุจู
`;
            navigator.clipboard.writeText(textToCopy);
            alert('ูุชู ฺฉูพ ุดุฏ!');
        });
    </script>
</body>
</html>
